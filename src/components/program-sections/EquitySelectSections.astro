---
interface Props {
  landing?: boolean;
}

const { landing = false } = Astro.props;

const landingKeyBenefits = [
  {
    icon: 'fa-solid fa-chart-line',
    title: 'Predictable Payments',
    text: 'Payment plans starting around 1% of the balance for steady, predictable budgeting',
  },
  {
    icon: 'fa-solid fa-shield-halved',
    title: 'Preserve Your Low-Rate First',
    text: 'Second-lien structure preserves your existing low-rate first mortgage',
  },
  {
    icon: 'fa-solid fa-layer-group',
    title: 'Consolidated Option',
    text: 'First-lien option consolidates everything into a single long-term solution',
  },
  {
    icon: 'fa-solid fa-hand-holding-dollar',
    title: 'Flexible Access',
    text: 'Flexible draws over time—use funds for improvements, medical costs, or strategic investments',
  },
];

const landingWhoForCards = [
  {
    icon: 'fa-solid fa-lock',
    title: 'Keep Your First Mortgage',
    text: 'Homeowners who want to unlock equity without refinancing out of a low-rate mortgage',
  },
  {
    icon: 'fa-solid fa-calendar-check',
    title: 'Long-Term Planning',
    text: 'Retirees and near-retirees seeking structured, long-term payments',
  },
  {
    icon: 'fa-solid fa-screwdriver-wrench',
    title: 'Ongoing Projects & Needs',
    text: 'Families needing ongoing access to funds for renovations, healthcare, or debt payoff',
  },
  {
    icon: 'fa-solid fa-scale-balanced',
    title: 'Explore Alternatives',
    text: 'Clients exploring alternatives to reverse mortgages while maintaining required payments',
  },
  {
    icon: 'fa-solid fa-wallet',
    title: 'Build a Cash Reserve',
    text: 'Homeowners who want a flexible credit line available for planned or unexpected expenses',
  },
  {
    icon: 'fa-solid fa-flag-checkered',
    title: 'Prefer a Clear Next Step',
    text: 'Borrowers who want to compare options quickly without committing to a refinance upfront',
  },
];

const equitySelectCompareColumns = [
  { key: 'equitySelect', label: 'EquitySelect (HELOC)' },
  { key: 'cashOutRefi', label: 'Cash-Out Refi' },
  { key: 'personalLoan', label: 'Personal Loan' },
];

const equitySelectCompareRows = [
  {
    feature: 'Keep low-rate 1st mortgage',
    equitySelect: true,
    cashOutRefi: false,
    personalLoan: true,
    delay: '60ms',
  },
  {
    feature: 'Access funds over time',
    equitySelect: true,
    cashOutRefi: false,
    personalLoan: false,
    delay: '140ms',
  },
  {
    feature: 'Lower closing costs (vs mortgage)',
    equitySelect: true,
    cashOutRefi: false,
    personalLoan: true,
    delay: '220ms',
  },
  {
    feature: 'Payment flexibility options',
    equitySelect: true,
    cashOutRefi: false,
    personalLoan: false,
    delay: '300ms',
  },
];
---
{!landing && (
  <section class="py-10 md:py-16">
    <div class="max-w-5xl mx-auto px-4 text-center">
      <h1 class="text-3xl md:text-4xl font-semibold mb-4">
        EquitySelect – Flexible Home-Equity Line of Credit
      </h1>
      <p class="text-base md:text-lg text-muted-foreground max-w-3xl mx-auto">
        EquitySelect is a home-equity line available as either a first- or second-lien. Keep an existing low-rate mortgage in place with the second-lien structure, or consolidate everything into a first position—while unlocking payment plans that can begin around <strong>1% of the balance</strong> for predictable, long-term planning.
      </p>
    </div>

    <div class="max-w-5xl mx-auto px-4 mt-10 grid md:grid-cols-3 gap-6">
      <div class="p-5 rounded-2xl border bg-muted/30 shadow-sm">
        <h3 class="font-medium mb-1">Expert Guidance</h3>
        <p class="text-sm text-muted-foreground">
          Work with a local mortgage broker who understands specialized equity programs and can walk you through the options step by step.
        </p>
      </div>
      <div class="p-5 rounded-2xl border bg-muted/30 shadow-sm">
        <h3 class="font-medium mb-1">More Options</h3>
        <p class="text-sm text-muted-foreground">
          Compare EquitySelect alongside HELOCs, cash-out refinances, and Reverse Mortgages to find the best fit for your situation.
        </p>
      </div>
      <div class="p-5 rounded-2xl border bg-muted/30 shadow-sm">
        <h3 class="font-medium mb-1">Colorado Focus</h3>
        <p class="text-sm text-muted-foreground">
          Designed with Colorado homeowners in mind, with lenders and guidelines that understand our local markets.
        </p>
      </div>
    </div>
  </section>
)}

{landing ? (
  <>
    <section class="py-12 md:py-16 bg-white">
      <div class="container mx-auto px-4 sm:px-6 lg:px-8">
        <div class="grid xl:grid-cols-2 gap-10 items-start">
          <div class="max-w-3xl flex flex-col justify-center md:min-h-[360px]">
            <div class="mb-4">
              <div class="inline-flex items-center justify-center w-12 h-12 rounded-full bg-gray-100 border">
                <i class="fa-solid fa-house-circle-check text-xl text-[#bf9f5c]"></i>
              </div>
            </div>
            <h2 class="text-2xl md:text-3xl font-semibold text-gray-900">Program Overview</h2>
            <p class="mt-4 text-sm md:text-base text-muted-foreground">
              EquitySelect is a flexible home-equity line designed to complement today’s low-rate mortgage market. Borrowers can opt for a second-lien that keeps their original mortgage intact or refinance into a first-lien for a consolidated solution. Either way, predictable payments that can start around 1% of the balance help support long-term budgets, renovations, and retirement planning.
            </p>
            <p class="mt-4 text-sm md:text-base text-muted-foreground">
              Get a free quote to confirm eligibility, estimated limits, and payment options.
            </p>
            <div class="mt-6">
              <a
                href="https://www.cliffmortgages.com/get-a-quote"
                class="inline-flex items-center justify-center px-8 py-4 bg-[#bf9f5c] text-white font-semibold rounded-lg shadow-md hover:bg-[#a68a4c] transition duration-300 whitespace-nowrap"
              >
                Check EquitySelect Options
              </a>
            </div>
          </div>

          <div class="rounded-2xl bg-gray-50 p-6 md:p-8 shadow-sm opacity-0 translate-y-3" data-animate="es-compare">
            <div class="flex items-start justify-between gap-4">
              <div>
                <h3 class="text-lg font-semibold text-gray-900">How EquitySelect compares</h3>
                <p class="mt-1 text-sm text-muted-foreground">A quick, high-level comparison (general guidelines).</p>
              </div>
              <div class="hidden sm:flex items-center gap-2 text-xs text-gray-600">
                <span class="inline-flex items-center gap-1">
                  <i class="fa-solid fa-circle-check text-[#bf9f5c]"></i>
                  <span>Typically</span>
                </span>
                <span class="inline-flex items-center gap-1">
                  <i class="fa-solid fa-circle-xmark text-gray-400"></i>
                  <span>Typically not</span>
                </span>
              </div>
            </div>

            <div class="mt-5">
              <div class="md:hidden space-y-4">
                {equitySelectCompareRows.map((row) => (
                  <div class="rounded-xl bg-white border p-4">
                    <p class="text-sm font-semibold text-gray-900">{row.feature}</p>
                    <div class="mt-3 space-y-2">
                      {equitySelectCompareColumns.map((col) => (
                        <div class="flex items-center justify-between gap-3">
                          <span class="text-xs text-gray-600">{col.label}</span>
                          {row[col.key] ? (
                            <i class="fa-solid fa-circle-check text-[#bf9f5c]"></i>
                          ) : (
                            <i class="fa-solid fa-circle-xmark text-gray-400"></i>
                          )}
                        </div>
                      ))}
                    </div>
                  </div>
                ))}
              </div>

              <div class="hidden md:block">
                <table class="w-full text-left text-sm">
                  <thead>
                    <tr class="text-xs uppercase tracking-wide text-gray-500">
                      <th class="py-3 pr-4">Feature</th>
                      {equitySelectCompareColumns.map((col) => (
                        <th class="py-3 px-3 whitespace-nowrap">{col.label}</th>
                      ))}
                    </tr>
                  </thead>
                  <tbody class="text-gray-700">
                    {equitySelectCompareRows.map((row) => (
                      <tr
                        class="border-t border-gray-200 opacity-0 translate-y-2"
                        data-animate-row="es-compare"
                        style={`transition-delay: ${row.delay}`}
                      >
                        <td class="py-3 pr-4 font-medium text-gray-900">{row.feature}</td>
                        {equitySelectCompareColumns.map((col) => (
                          <td class="py-3 px-3">
                            {row[col.key] ? (
                              <i class="fa-solid fa-circle-check text-[#bf9f5c]"></i>
                            ) : (
                              <i class="fa-solid fa-circle-xmark text-gray-400"></i>
                            )}
                          </td>
                        ))}
                      </tr>
                    ))}
                  </tbody>
                </table>
              </div>
            </div>

            <p class="mt-4 text-xs text-muted-foreground">
              Actual eligibility, costs, and terms vary by lender, credit, equity, and market conditions.
            </p>

            <style>
              [data-animate="es-compare"],
              [data-animate-row="es-compare"] {
                transition: opacity 600ms ease, transform 600ms ease;
              }
              [data-animate="es-compare"].is-visible {
                opacity: 1;
                transform: translateY(0);
              }
              [data-animate-row="es-compare"].is-visible {
                opacity: 1;
                transform: translateY(0);
              }
            </style>

            <script is:inline>
              (() => {
                const container = document.querySelector('[data-animate="es-compare"]');
                if (!container) return;
                const rows = Array.from(document.querySelectorAll('[data-animate-row="es-compare"]'));
                const observer = new IntersectionObserver(
                  (entries) => {
                    for (const entry of entries) {
                      if (!entry.isIntersecting) continue;
                      container.classList.add('is-visible');
                      rows.forEach((row) => row.classList.add('is-visible'));
                      observer.disconnect();
                    }
                  },
                  { threshold: 0.25 }
                );
                observer.observe(container);
              })();
            </script>
          </div>
        </div>
      </div>
    </section>

    <section class="py-12 md:py-16 bg-gray-50">
      <div class="container mx-auto px-4 sm:px-6 lg:px-8">
        <div class="rounded-2xl bg-white shadow-sm p-6 md:p-8">
          <h2 class="text-2xl md:text-3xl font-semibold text-gray-900">Key Benefits</h2>
          <div class="mt-6 grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 items-stretch">
            {landingKeyBenefits.map((benefit) => (
              <div class="rounded-2xl border bg-gray-50 p-5 shadow-sm h-full">
                <div class="flex items-center gap-4 h-full">
                  <div class="flex-shrink-0 w-12 h-12 rounded-full bg-white border flex items-center justify-center">
                    <i class={`${benefit.icon} text-xl text-[#bf9f5c]`}></i>
                  </div>
                  <div class="flex flex-col justify-center">
                    <p class="text-sm font-semibold text-gray-900">{benefit.title}</p>
                    <p class="mt-1 text-sm text-muted-foreground">{benefit.text}</p>
                  </div>
                </div>
              </div>
            ))}
          </div>
        </div>
      </div>
    </section>

    <section class="py-10 bg-[#09143e]">
      <div class="container mx-auto px-4 sm:px-6 lg:px-8">
        <div class="rounded-2xl border border-white/10 bg-white/5 p-6 md:p-8 flex flex-col md:flex-row md:items-center md:justify-between gap-6">
          <div class="max-w-2xl">
            <h3 class="text-xl md:text-2xl font-semibold text-white">See if EquitySelect is a fit</h3>
            <p class="mt-2 text-sm md:text-base text-gray-200">
              Request a free quote to explore EquitySelect without refinancing your low-rate first mortgage.
            </p>
          </div>
          <a
            href="https://www.cliffmortgages.com/get-a-quote"
            class="inline-flex items-center justify-center px-8 py-4 bg-[#bf9f5c] text-white font-semibold rounded-lg shadow-md hover:bg-[#a68a4c] transition duration-300 whitespace-nowrap"
          >
            Check EquitySelect Options
          </a>
        </div>
      </div>
    </section>

    <section class="py-12 md:py-16 bg-white">
      <div class="container mx-auto px-4 sm:px-6 lg:px-8">
        <div class="grid md:grid-cols-2 gap-10 items-stretch">
          <div class="flex flex-col justify-center">
            <h2 class="text-2xl md:text-3xl font-semibold text-gray-900">Who is this for?</h2>
            <p class="mt-4 text-sm md:text-base text-muted-foreground">
              This loan may be a great fit if you meet the following general criteria:
            </p>
            <div class="mt-6 grid grid-cols-1 sm:grid-cols-2 gap-4 items-stretch">
              {landingWhoForCards.map((item) => (
                <div class="rounded-2xl border bg-gray-50 p-5 shadow-sm h-full">
                  <div class="flex items-center gap-4 h-full">
                    <div class="flex-shrink-0 w-12 h-12 rounded-full bg-white border flex items-center justify-center">
                      <i class={`${item.icon} text-xl text-[#bf9f5c]`}></i>
                    </div>
                    <div class="flex flex-col justify-center">
                      <p class="text-sm font-semibold text-gray-900">{item.title}</p>
                      <p class="mt-1 text-sm text-muted-foreground">{item.text}</p>
                    </div>
                  </div>
                </div>
              ))}
            </div>
          </div>

          <div class="rounded-2xl bg-gray-50 p-6 md:p-8 shadow-sm" data-heloc-quiz>
            <div class="flex items-start gap-4">
              <div class="flex-shrink-0 w-12 h-12 rounded-full bg-white border flex items-center justify-center">
                <i class="fa-solid fa-wand-magic-sparkles text-xl text-[#bf9f5c]"></i>
              </div>
              <div>
                <h3 class="text-lg font-semibold text-gray-900">HELOC Decision Guide</h3>
                <p class="mt-1 text-sm text-muted-foreground">
                  A short, step-by-step questionnaire to help you decide. General guidance—no obligation.
                </p>
              </div>
            </div>

            <div class="mt-5" data-heloc-swap>
              <div class="transition-opacity duration-500" data-heloc-wizard>
                <div>
                  <div class="flex items-center justify-between text-xs text-gray-600">
                    <span data-heloc-progress-label>Step 1 of 5</span>
                    <span data-heloc-progress-pct>0%</span>
                  </div>
                  <div class="mt-2 h-2 rounded-full bg-gray-200 overflow-hidden">
                    <div class="h-full bg-[#bf9f5c] w-0 transition-all duration-500" data-heloc-progress-bar></div>
                  </div>
                </div>

                <div class="mt-5" data-heloc-steps>
                  <div data-step="0">
                    <p class="text-sm font-semibold text-gray-900">What are you using home equity for?</p>
                    <div class="mt-3 space-y-3">
                      <label class="block rounded-xl bg-white border p-4 cursor-pointer hover:bg-gray-50">
                        <input class="sr-only" type="radio" name="q0" value="10" />
                        <div class="flex items-center gap-3">
                          <i class="fa-solid fa-hammer mt-0.5 text-[#bf9f5c]"></i>
                          <div>
                            <p class="text-sm font-semibold text-gray-900">Home repairs / remodel</p>
                            <p class="mt-1 text-sm text-muted-foreground">Projects where flexible draw timing is helpful.</p>
                          </div>
                        </div>
                      </label>
                      <label class="block rounded-xl bg-white border p-4 cursor-pointer hover:bg-gray-50">
                        <input class="sr-only" type="radio" name="q0" value="8" />
                        <div class="flex items-center gap-3">
                          <i class="fa-solid fa-credit-card mt-0.5 text-[#bf9f5c]"></i>
                          <div>
                            <p class="text-sm font-semibold text-gray-900">Debt payoff / consolidation</p>
                            <p class="mt-1 text-sm text-muted-foreground">Potentially simplify payments (when appropriate).</p>
                          </div>
                        </div>
                      </label>
                      <label class="block rounded-xl bg-white border p-4 cursor-pointer hover:bg-gray-50">
                        <input class="sr-only" type="radio" name="q0" value="7" />
                        <div class="flex items-center gap-3">
                          <i class="fa-solid fa-graduation-cap mt-0.5 text-[#bf9f5c]"></i>
                          <div>
                            <p class="text-sm font-semibold text-gray-900">Planned expenses</p>
                            <p class="mt-1 text-sm text-muted-foreground">Education, medical, or other planned costs.</p>
                          </div>
                        </div>
                      </label>
                      <label class="block rounded-xl bg-white border p-4 cursor-pointer hover:bg-gray-50">
                        <input class="sr-only" type="radio" name="q0" value="5" />
                        <div class="flex items-center gap-3">
                          <i class="fa-solid fa-life-ring mt-0.5 text-[#bf9f5c]"></i>
                          <div>
                            <p class="text-sm font-semibold text-gray-900">Emergency buffer / flexibility</p>
                            <p class="mt-1 text-sm text-muted-foreground">A line you can access if you need it.</p>
                          </div>
                        </div>
                      </label>
                    </div>
                  </div>

                  <div data-step="1" class="hidden">
                    <p class="text-sm font-semibold text-gray-900">Do you want to keep your current first mortgage in place?</p>
                    <div class="mt-3 grid grid-cols-1 sm:grid-cols-3 gap-3 items-stretch">
                      <label class="rounded-xl bg-white border p-4 cursor-pointer hover:bg-gray-50 h-full flex flex-col justify-center">
                        <input class="sr-only" type="radio" name="q1" value="10" />
                        <p class="text-sm font-semibold text-gray-900">Yes</p>
                        <p class="mt-1 text-sm text-muted-foreground">I don’t want to refinance it.</p>
                      </label>
                      <label class="rounded-xl bg-white border p-4 cursor-pointer hover:bg-gray-50 h-full flex flex-col justify-center">
                        <input class="sr-only" type="radio" name="q1" value="6" />
                        <p class="text-sm font-semibold text-gray-900">Not sure</p>
                        <p class="mt-1 text-sm text-muted-foreground">I’m open to options.</p>
                      </label>
                      <label class="rounded-xl bg-white border p-4 cursor-pointer hover:bg-gray-50 h-full flex flex-col justify-center">
                        <input class="sr-only" type="radio" name="q1" value="2" />
                        <p class="text-sm font-semibold text-gray-900">No</p>
                        <p class="mt-1 text-sm text-muted-foreground">I might refinance anyway.</p>
                      </label>
                    </div>
                  </div>

                  <div data-step="2" class="hidden">
                    <p class="text-sm font-semibold text-gray-900">Do you need flexibility to draw funds over time?</p>
                    <div class="mt-3 grid grid-cols-1 sm:grid-cols-3 gap-3 items-stretch">
                      <label class="rounded-xl bg-white border p-4 cursor-pointer hover:bg-gray-50 h-full flex flex-col justify-center">
                        <input class="sr-only" type="radio" name="q2" value="10" />
                        <p class="text-sm font-semibold text-gray-900">Yes</p>
                        <p class="mt-1 text-sm text-muted-foreground">I want access when needed.</p>
                      </label>
                      <label class="rounded-xl bg-white border p-4 cursor-pointer hover:bg-gray-50 h-full flex flex-col justify-center">
                        <input class="sr-only" type="radio" name="q2" value="6" />
                        <p class="text-sm font-semibold text-gray-900">Maybe</p>
                        <p class="mt-1 text-sm text-muted-foreground">Depends on the terms.</p>
                      </label>
                      <label class="rounded-xl bg-white border p-4 cursor-pointer hover:bg-gray-50 h-full flex flex-col justify-center">
                        <input class="sr-only" type="radio" name="q2" value="2" />
                        <p class="text-sm font-semibold text-gray-900">No</p>
                        <p class="mt-1 text-sm text-muted-foreground">I prefer a lump sum.</p>
                      </label>
                    </div>
                  </div>

                  <div data-step="3" class="hidden">
                    <p class="text-sm font-semibold text-gray-900">What’s your timeline?</p>
                    <div class="mt-3 grid grid-cols-1 sm:grid-cols-3 gap-3 items-stretch">
                      <label class="rounded-xl bg-white border p-4 cursor-pointer hover:bg-gray-50 h-full flex flex-col justify-center">
                        <input class="sr-only" type="radio" name="q3" value="8" />
                        <p class="text-sm font-semibold text-gray-900">0–3 months</p>
                        <p class="mt-1 text-sm text-muted-foreground">Soon / active project.</p>
                      </label>
                      <label class="rounded-xl bg-white border p-4 cursor-pointer hover:bg-gray-50 h-full flex flex-col justify-center">
                        <input class="sr-only" type="radio" name="q3" value="10" />
                        <p class="text-sm font-semibold text-gray-900">3–12 months</p>
                        <p class="mt-1 text-sm text-muted-foreground">Planning ahead.</p>
                      </label>
                      <label class="rounded-xl bg-white border p-4 cursor-pointer hover:bg-gray-50 h-full flex flex-col justify-center">
                        <input class="sr-only" type="radio" name="q3" value="6" />
                        <p class="text-sm font-semibold text-gray-900">12+ months</p>
                        <p class="mt-1 text-sm text-muted-foreground">Long-term option.</p>
                      </label>
                    </div>
                  </div>

                  <div data-step="4" class="hidden">
                    <p class="text-sm font-semibold text-gray-900">How do you feel about payment/rate flexibility?</p>
                    <div class="mt-3 space-y-3">
                      <label class="block rounded-xl bg-white border p-4 cursor-pointer hover:bg-gray-50">
                        <input class="sr-only" type="radio" name="q4" value="10" />
                        <p class="text-sm font-semibold text-gray-900">I’m comfortable with flexibility</p>
                        <p class="mt-1 text-sm text-muted-foreground">I can handle a line/variable-style structure.</p>
                      </label>
                      <label class="block rounded-xl bg-white border p-4 cursor-pointer hover:bg-gray-50">
                        <input class="sr-only" type="radio" name="q4" value="6" />
                        <p class="text-sm font-semibold text-gray-900">Not sure</p>
                        <p class="mt-1 text-sm text-muted-foreground">I want to see options and understand tradeoffs.</p>
                      </label>
                      <label class="block rounded-xl bg-white border p-4 cursor-pointer hover:bg-gray-50">
                        <input class="sr-only" type="radio" name="q4" value="2" />
                        <p class="text-sm font-semibold text-gray-900">I strongly prefer fixed payments</p>
                        <p class="mt-1 text-sm text-muted-foreground">A fixed-term loan may be better.</p>
                      </label>
                    </div>
                  </div>
                </div>

                <div class="mt-5 flex items-center justify-between gap-3">
                  <button
                    type="button"
                    class="px-4 py-2 rounded-lg border bg-white text-sm font-semibold text-gray-800 hover:bg-gray-50 transition"
                    data-heloc-back
                  >
                    Back
                  </button>
                </div>

                <p class="mt-4 text-xs text-muted-foreground">
                  Your results will appear after the final step.
                </p>
              </div>

              <div class="transition-opacity duration-500 opacity-0 pointer-events-none hidden" data-heloc-results>
                <div class="rounded-xl bg-white border p-5">
                  <div class="flex items-center justify-between">
                    <p class="text-sm font-semibold text-gray-900">HELOC Confidence</p>
                    <p class="text-sm font-semibold text-gray-900" data-heloc-score>0%</p>
                  </div>
                  <div class="mt-3 h-3 rounded-full bg-gray-200 overflow-hidden">
                    <div class="h-full bg-[#bf9f5c] w-0 transition-all duration-700" data-heloc-score-bar></div>
                  </div>
                  <p class="mt-3 text-sm font-semibold text-gray-900" data-heloc-result-title>Results</p>
                  <p class="mt-2 text-sm text-muted-foreground" data-heloc-score-text>
                    Complete the steps to see how strongly a HELOC could match your goals.
                  </p>

                  <ul class="mt-4 space-y-2 text-sm text-muted-foreground" data-heloc-result-bullets>
                    <li class="flex items-start gap-3">
                      <span class="text-[#bf9f5c] font-bold">&raquo;</span>
                      <span>Answer the questions to see your personalized guidance.</span>
                    </li>
                  </ul>

                  <div class="mt-6">
                    <a
                      href="https://www.cliffmortgages.com/get-a-quote"
                      class="inline-flex items-center justify-center w-full px-6 py-4 bg-[#bf9f5c] text-white font-semibold rounded-lg shadow-md hover:bg-[#a68a4c] transition duration-300"
                    >
                      Check EquitySelect Options
                    </a>
                    <p class="mt-3 text-xs text-muted-foreground">
                      We’ll confirm eligibility, pricing, and the best structure for your situation.
                    </p>
                    <button
                      type="button"
                      class="mt-4 text-xs underline text-gray-600 hover:text-gray-900"
                      data-heloc-restart
                    >
                      Start over
                    </button>
                  </div>
                </div>
              </div>
            </div>

            <script is:inline>
              (() => {
                const root = document.querySelector('[data-heloc-quiz]');
                if (!root) return;

                const stepsWrap = root.querySelector('[data-heloc-steps]');
                if (!stepsWrap) return;
                const steps = Array.from(stepsWrap.querySelectorAll('[data-step]'));

                const backBtn = root.querySelector('[data-heloc-back]');
                const progressLabel = root.querySelector('[data-heloc-progress-label]');
                const progressPct = root.querySelector('[data-heloc-progress-pct]');
                const progressBar = root.querySelector('[data-heloc-progress-bar]');

                const scoreEl = root.querySelector('[data-heloc-score]');
                const scoreBar = root.querySelector('[data-heloc-score-bar]');
                const scoreText = root.querySelector('[data-heloc-score-text]');

                const totalSteps = steps.length;
                const maxPerStep = 10;
                const maxScore = totalSteps * maxPerStep;

                let idx = 0;

                const getScore = () => {
                  let sum = 0;
                  for (let i = 0; i < totalSteps; i++) {
                    const checked = root.querySelector(`input[name="q${i}"]:checked`);
                    if (!checked) continue;
                    const v = parseInt(checked.value, 10);
                    sum += Number.isFinite(v) ? v : 0;
                  }
                  const pct = Math.round((sum / maxScore) * 100);
                  return Math.max(0, Math.min(100, pct));
                };

                const scoreCopy = (pct) => {
                  if (pct >= 80) {
                    return 'High confidence: a HELOC-style option may match your goals (especially if keeping a low-rate first mortgage matters).';
                  }
                  if (pct >= 55) {
                    return 'Moderate confidence: a HELOC could be a fit, but your best option depends on rates, equity, and structure.';
                  }
                  if (pct > 0) {
                    return 'Lower confidence: a HELOC may still help, but a fixed loan or other option could be better depending on your goals.';
                  }
                  return 'Complete the steps to see how strongly a HELOC could match your goals.';
                };

                const resultTitleCopy = (pct) => {
                  if (pct >= 80) return 'Strong HELOC fit based on your answers';
                  if (pct >= 55) return 'Possible HELOC fit — worth comparing options';
                  if (pct > 0) return 'HELOC may or may not be ideal — let’s confirm';
                  return 'Results';
                };

                const resultBulletsCopy = (pct) => {
                  if (pct >= 80) {
                    return [
                      'A HELOC can help you access equity while keeping a low-rate first mortgage in place.',
                      'Flexible draw access can match projects or expenses that happen over time.',
                      'Next step: get a free quote to confirm limits, payment options, and costs.',
                    ];
                  }
                  if (pct >= 55) {
                    return [
                      'A HELOC could work, but you may also want to compare a fixed option depending on your goals.',
                      'The best fit depends on your equity, credit profile, timeline, and how you want payments structured.',
                      'Next step: get a free quote so we can compare options side-by-side.',
                    ];
                  }
                  if (pct > 0) {
                    return [
                      'A HELOC may still help, but a fixed loan/refi could be more predictable depending on your situation.',
                      'If keeping your first mortgage is important, a second-lien option may still be worth exploring.',
                      'Next step: get a free quote to confirm what you qualify for and the pros/cons.',
                    ];
                  }
                  return ['Complete the steps to see your personalized guidance.'];
                };

                const showResults = () => {
                  const wizard = root.querySelector('[data-heloc-wizard]');
                  const results = root.querySelector('[data-heloc-results]');
                  if (!wizard || !results) return;

                  const pct = getScore();
                  if (scoreEl) scoreEl.textContent = `${pct}%`;
                  if (scoreBar) scoreBar.style.width = `${pct}%`;
                  if (scoreText) scoreText.textContent = scoreCopy(pct);

                  const title = root.querySelector('[data-heloc-result-title]');
                  if (title) title.textContent = resultTitleCopy(pct);

                  const bullets = root.querySelector('[data-heloc-result-bullets]');
                  if (bullets) {
                    const items = resultBulletsCopy(pct);
                    bullets.innerHTML = items
                      .map(
                        (t) =>
                          `<li class="flex items-start gap-3"><span class="text-[#bf9f5c] font-bold">&raquo;</span><span>${t}</span></li>`
                      )
                      .join('');
                  }

                  wizard.classList.add('opacity-0');
                  wizard.classList.add('pointer-events-none');
                  window.setTimeout(() => {
                    wizard.classList.add('hidden');
                    results.classList.remove('hidden');
                    results.classList.remove('pointer-events-none');
                    window.requestAnimationFrame(() => {
                      results.classList.remove('opacity-0');
                    });
                  }, 260);
                };

                const restart = () => {
                  for (let i = 0; i < totalSteps; i++) {
                    const checked = root.querySelector(`input[name="q${i}"]:checked`);
                    if (checked) checked.checked = false;
                  }
                  idx = 0;
                  const wizard = root.querySelector('[data-heloc-wizard]');
                  const results = root.querySelector('[data-heloc-results]');
                  if (results) {
                    results.classList.add('opacity-0');
                    results.classList.add('pointer-events-none');
                    results.classList.add('hidden');
                  }
                  if (wizard) {
                    wizard.classList.remove('hidden');
                    wizard.classList.remove('opacity-0');
                    wizard.classList.remove('pointer-events-none');
                  }
                  render();
                };

                const render = () => {
                  steps.forEach((el, i) => {
                    el.classList.toggle('hidden', i !== idx);
                  });

                  if (progressLabel) progressLabel.textContent = `Step ${idx + 1} of ${totalSteps}`;
                  const answered = Array.from({ length: totalSteps }).filter((_, i) => !!root.querySelector(`input[name="q${i}"]:checked`)).length;
                  const pctAnswered = Math.round((answered / totalSteps) * 100);
                  if (progressPct) progressPct.textContent = `${pctAnswered}%`;
                  if (progressBar) progressBar.style.width = `${pctAnswered}%`;

                  if (backBtn) backBtn.disabled = idx === 0;
                  if (backBtn) backBtn.classList.toggle('opacity-50', idx === 0);
                  if (backBtn) backBtn.classList.toggle('cursor-not-allowed', idx === 0);

                  const score = getScore();
                  if (scoreEl) scoreEl.textContent = `${score}%`;
                  if (scoreBar) scoreBar.style.width = `${score}%`;
                  if (scoreText) scoreText.textContent = scoreCopy(score);
                };

                const onNext = () => {
                  if (idx === totalSteps - 1) {
                    const stepAnswered = !!root.querySelector(`input[name="q${idx}"]:checked`);
                    if (stepAnswered) {
                      showResults();
                    }
                    return;
                  }
                  idx += 1;
                  render();
                };

                const onBack = () => {
                  if (idx === 0) return;
                  idx -= 1;
                  render();
                };

                root.addEventListener('change', (e) => {
                  const t = e.target;
                  if (!(t instanceof HTMLInputElement)) return;
                  if (t.type !== 'radio') return;

                  const selectedStep = (() => {
                    if (!t.name || !t.name.startsWith('q')) return null;
                    const step = parseInt(t.name.slice(1), 10);
                    return Number.isFinite(step) ? step : null;
                  })();

                  render();

                  if (selectedStep === null) return;
                  if (selectedStep !== idx) return;
                  if (idx >= totalSteps - 1) {
                    window.setTimeout(() => {
                      const stillOnSameStep = idx === selectedStep;
                      const stillAnswered = !!root.querySelector(`input[name="q${selectedStep}"]:checked`);
                      if (!stillOnSameStep || !stillAnswered) return;
                      showResults();
                    }, 260);
                    return;
                  }

                  window.setTimeout(() => {
                    const stillOnSameStep = idx === selectedStep;
                    const stillAnswered = !!root.querySelector(`input[name="q${selectedStep}"]:checked`);
                    if (!stillOnSameStep || !stillAnswered) return;
                    onNext();
                  }, 220);
                });

                const restartBtn = root.querySelector('[data-heloc-restart]');
                if (restartBtn) restartBtn.addEventListener('click', restart);
                if (backBtn) backBtn.addEventListener('click', onBack);

                render();
              })();
            </script>
          </div>
        </div>

        <div class="mt-10 rounded-2xl border bg-gray-50 p-6 md:p-8">
          <p class="text-xs text-muted-foreground">
            *These are general guidelines. Contact us for a personalized assessment. Not a commitment to lend.*
          </p>
          <p class="text-xs text-muted-foreground italic mt-2">
            EquitySelect allows monthly payment options that may be less than the interest accrued. If the selected monthly payment does not cover all interest due, the unpaid interest will be added to the loan balance. This may result in a larger balance and a balloon payment due at loan payoff or at the end of the loan term.
          </p>
          <p class="text-xs text-muted-foreground italic mt-2">
            EquitySelect requires a minimum initial draw of 50% of the available line of credit or $75,000, whichever is greater. The program includes a defined draw period, after which additional funds may not be withdrawn.
          </p>
        </div>
      </div>
    </section>
  </>
) : (
  <section class="py-12 md:py-16 bg-white">
    <div class="max-w-5xl mx-auto px-4 grid md:grid-cols-2 gap-10">
      <div>
        <h2 class="text-2xl font-semibold mb-3">Program Overview</h2>
        <p class="text-sm md:text-base text-muted-foreground mb-5">
          EquitySelect is a flexible home-equity line designed to complement today’s low-rate mortgage market. Borrowers can opt for a second-lien that keeps their original mortgage intact or refinance into a first-lien for a consolidated solution. Either way, predictable payments that can start around 1% of the balance help support long-term budgets, renovations, and retirement planning.
        </p>

        <h3 class="text-lg font-semibold mb-2">Key Benefits</h3>
        <ul class="list-disc list-inside space-y-1 text-sm text-muted-foreground">
          <li>Payment plans starting around 1% of the balance for steady, predictable budgeting</li>
          <li>Second-lien structure preserves your existing low-rate first mortgage</li>
          <li>First-lien option consolidates everything into a single long-term solution</li>
          <li>Flexible draws over time—use funds for improvements, medical costs, or strategic investments</li>
        </ul>
      </div>

      <div>
        <h2 class="text-2xl font-semibold mb-3">Who is this for?</h2>
        <p class="text-sm text-muted-foreground mb-3">
          This loan may be a great fit if you meet the following general criteria:
        </p>
        <ul class="space-y-1 text-sm text-muted-foreground">
          <li>» Homeowners who want to unlock equity without refinancing out of a low-rate mortgage</li>
          <li>» Retirees and near-retirees seeking structured, long-term payments</li>
          <li>» Families needing ongoing access to funds for renovations, healthcare, or debt payoff</li>
          <li>» Clients exploring alternatives to reverse mortgages while maintaining required payments</li>
        </ul>

        <p class="text-xs text-muted-foreground mt-3">
          *These are general guidelines. Contact us for a personalized assessment. Not a commitment to lend.*
        </p>
        <p class="text-xs text-muted-foreground italic mt-1">
          EquitySelect allows monthly payment options that may be less than the interest accrued. If the selected monthly payment does not cover all interest due, the unpaid interest will be added to the loan balance. This may result in a larger balance and a balloon payment due at loan payoff or at the end of the loan term.
        </p>
        <p class="text-xs text-muted-foreground italic mt-1">
          EquitySelect requires a minimum initial draw of 50% of the available line of credit or $75,000, whichever is greater. The program includes a defined draw period, after which additional funds may not be withdrawn.
        </p>
      </div>
    </div>
  </section>
)}

{!landing && (
  <>
    <section class="py-12">
      <div class="max-w-5xl mx-auto px-4">
        <h2 class="text-2xl font-semibold text-center mb-4">
          Why Choose Cliff Mortgages for EquitySelect
        </h2>
        <p class="text-center text-muted-foreground mb-10 max-w-3xl mx-auto text-sm md:text-base">
          This specialized product requires expert guidance. We provide clear, unbiased guidance to help you determine whether <strong>EquitySelect</strong> is the right fit for your long-term financial goals.
        </p>

        <div class="grid md:grid-cols-3 gap-6">
          <div class="p-6 rounded-2xl border bg-muted/30 shadow-sm">
            <h3 class="font-medium text-lg mb-2">Unbiased Equity Advice</h3>
            <p class="text-sm text-muted-foreground">
              Compare EquitySelect with traditional HELOCs and Reverse Mortgages to understand the pros and cons of each option.
            </p>
          </div>
          <div class="p-6 rounded-2xl border bg-muted/30 shadow-sm">
            <h3 class="font-medium text-lg mb-2">Access to Specialized Lenders</h3>
            <p class="text-sm text-muted-foreground">
              Not all lenders offer programs like EquitySelect. Our broker relationships ensure access and competitive terms.
            </p>
          </div>
          <div class="p-6 rounded-2xl border bg-muted/30 shadow-sm">
            <h3 class="font-medium text-lg mb-2">Clear, Simple Explanations</h3>
            <p class="text-sm text-muted-foreground">
              We break down complex concepts so you understand how required payments and credit line features work.
            </p>
          </div>
        </div>
      </div>
    </section>

    <section class="py-12 pb-16">
      <div class="max-w-5xl mx-auto px-4">
        <h2 class="text-2xl font-semibold text-center mb-4">
          Find Your Perfect Equity Solution
        </h2>
        <p class="text-center text-muted-foreground mb-10 max-w-3xl mx-auto text-sm md:text-base">
          <strong>EquitySelect</strong> bridges the gap between traditional HELOCs and Reverse Mortgages — helping you choose the right solution for your long-term financial needs.
        </p>

        <div class="grid md:grid-cols-3 gap-6">
          <div class="p-6 rounded-2xl border bg-muted/30 shadow-sm">
            <h3 class="font-medium text-lg mb-2">HELOC</h3>
            <ul class="space-y-2 text-sm text-muted-foreground">
              <li><strong>Best for:</strong> Short-term projects, flexible access.</li>
              <li><strong>Payment:</strong> Often interest-only; can be variable.</li>
              <li><strong>Key Feature:</strong> Revolving credit for a set “draw” period.</li>
            </ul>
          </div>

          <div class="p-6 rounded-2xl border bg-yellow-50 shadow-sm border-yellow-300">
            <h3 class="font-medium text-lg mb-2">EquitySelect</h3>
            <ul class="space-y-2 text-sm text-muted-foreground">
              <li><strong>Best for:</strong> Long-term planning with manageable payments.</li>
              <li><strong>Payment:</strong> Required, low monthly payments (as low as 1%).</li>
              <li><strong>Key Feature:</strong> A flexible, long-term financial tool.</li>
            </ul>
          </div>

          <div class="p-6 rounded-2xl border bg-muted/30 shadow-sm">
            <h3 class="font-medium text-lg mb-2">Reverse Mortgage</h3>
            <ul class="space-y-2 text-sm text-muted-foreground">
              <li><strong>Best for:</strong> Seniors (62+) wanting to eliminate payments.</li>
              <li><strong>Payment:</strong> No monthly mortgage payments required.</li>
              <li><strong>Key Feature:</strong> Access equity without payment burden.</li>
            </ul>
          </div>
        </div>
      </div>
    </section>
  </>
)}
